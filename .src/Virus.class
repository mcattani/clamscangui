' Gambas class file

'' ' *********************************************************************************************************
'' ' Ce programme est un logiciel libre; vous pouvez le redistribuer ou le modifier suivant
'' ' les termes de la GNU General Public License telle que publiée par la Free Software Foundation ;
'' ' soit la version 3 de la licence, soit( à votre gré) toute version ultérieure.
'' ' Ce programme est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE ;
'' ' sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.
'' ' Consultez la GNU General Public License pour plus de détails.
'' ' Vous devez avoir reçu une copie de la GNU General Public License en même temps que ce programme ;
'' ' si ce n 'est pas le cas, consultez <http://www.gnu.org/licenses>.
'' ' *********************************************************************************************************

Public sDir As String[]

Public Sub Run() As Boolean

     Return Not Me.ShowModal()

End

Public Sub btnCerrar_Click()                                                    'Cerrar

     Me.Close(True)

End

Public Sub rePert()                                                             'réglages d'affichage

     If sDir.Count <= 0 Then
          btnEliminar.Enabled = False
          btnRestaurar.Enabled = False
     Else
          btnEliminar.Enabled = True
          btnRestaurar.Enabled = True
     Endif

End

Public Sub Form_Open()                                                          'ouverture de la quarantaine

     sDir = Dir(User.Home & "/.clamscangui/viruses/")
     FV1.Dir = User.Home & "/.clamscangui/viruses/"
     Me.Text = ("Cuarentena de ClamScanGui")
     rePert()

End

Public Sub btnEliminar_Click()                                                  'eliminar

     Dim i As Integer

     If FV1.Selection.Count > 0 Then
          If Message.Question(("¿Quieres borrar la selección?"), ("Si"), ("No")) = 2 Then
               Return
          Else
               For i = 0 To FV1.Selection.Max
                    Try Kill User.Home & "/.clamscangui/viruses/" &/ FV1.Selection.First
                    FV1.Reload
               Next
          Endif
     Endif

     FV1.Reload
     rePert()

End

Public Sub btnRestaurar_Click()                                                 'restaurar

     Dim i As Integer

     If FV1.Selection.Count > 0 Then
          If Message.Question(("¿Quieres restaurar la selección?"), ("Si"), ("No")) = 2 Then
               Return
          Else                                                                  'il faudrait afficher un tableau des fichiers déplacer
               For i = 0 To FV1.Selection.Max
                    ' Dialog.Path = User.Home & "/.clamscangui/viruses/" &/ FV1.Selection.First
                    Dialog.Title = ("¡Seleccione dónde restaurar el archivo!")
                    If Dialog.SelectDirectory() Then                            'dossier à choisir pour la restauration
                         Message(("¡El archivo no fue restaurado!"))
                         Return
                    Else                                                        'on restaure le fichier à l'endroit choisi
                         Try Copy User.Home & "/.clamscangui/viruses/" &/ FV1.Selection.First To Dialog.Path &/ FV1.Selection.First
                         If Not Error Then                                      'et on tue le fichier origine
                              Try Kill User.Home & "/.clamscangui/viruses/" &/ FV1.Selection.First
                              Message(("su archivo ha sido restaurado a la siguiente carpeta: \n") & Dialog.Path)
                         Else
                              Message(("Restaurar error"))
                         Endif
                         FV1.Reload
                    Endif
               Next
          Endif
     Endif

     FV1.Reload
     rePert()

End
