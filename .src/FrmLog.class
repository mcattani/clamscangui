' Gambas class file

'' ' *********************************************************************************************************
'' ' Ce programme est un logiciel libre; vous pouvez le redistribuer ou le modifier suivant
'' ' les termes de la GNU General Public License telle que publiée par la Free Software Foundation ;
'' ' soit la version 3 de la licence, soit( à votre gré) toute version ultérieure.
'' ' Ce programme est distribué dans l'espoir qu'il sera utile, mais SANS AUCUNE GARANTIE ;
'' ' sans même la garantie tacite de QUALITÉ MARCHANDE ou d'ADÉQUATION à UN BUT PARTICULIER.
'' ' Consultez la GNU General Public License pour plus de détails.
'' ' Vous devez avoir reçu une copie de la GNU General Public License en même temps que ce programme ;
'' ' si ce n 'est pas le cas, consultez <http://www.gnu.org/licenses>.
'' ' *********************************************************************************************************

Public Sub Run() As Boolean

     Return Not Me.ShowModal()

End

Public Sub btnCerrar_Click()

     Me.Close(True)

End

Public Sub Form_Open()

     Dim Montexte As String

     Me.Text = (" Registro de ClamScanGui ") & User.Home &/ ".clamscangui/ClamScanGui_Log.txt"
     Montexte = User.Home &/ ".clamscangui/ClamScanGui_Log.txt"

     TextArea1.Pos = 0
     TextArea1.Alignment = Align.Normal
     TextArea1.Text = File.Load(User.Home &/ ".clamscangui/ClamScanGui_Log.txt")
     If TextArea1.Text = "" Then
          TextArea1.Alignment = Align.Center
          TextArea1.Text = " --------| Fichier Vide |-------- "
     Endif

Catch
     Message.Info(("El archivo o directorio no existe"))
     Me.Close

End

Public Sub btnImpr_Click()

     Dim hreport As Report
     Dim Parties As String[]

     Parties = Split(TextArea1.Text, gb.NewLine)
     hreport = New Impr1(Parties)
     hreport.preview()

End
