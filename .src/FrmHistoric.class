' Gambas class file

Public Sub Run() As Boolean

     Return Not Me.ShowModal()

End

Public Sub btnCerrar_Click()

     Me.Close(True)

End

Public Sub Form_Open()

     Dim Montexte As String

     Me.Text = ("Historia de ClamScanGui : ") & User.Home &/ ".clamscangui/Historique.txt"
     Montexte = User.Home &/ ".clamscangui/Historique.txt"

     TextArea1.Pos = 0
     TextArea1.Alignment = Align.Normal
     TextArea1.Text = File.Load(User.Home &/ ".clamscangui/Historique.txt")
     If TextArea1.Text = "" Then
          TextArea1.Alignment = Align.Center
          TextArea1.Text = " --------| Fichier Vide |-------- "
     Endif

Catch
     Message.Info(("El archivo o directorio no existe"))
     Me.Close

End

Public Sub btnBorrar_Click()                                                    'effacement de l'Historique

     TextArea1.Text = ""
     If Exist(User.Home &/ ".clamscangui/Historique.txt") Then
          File.Save(User.Home &/ ".clamscangui/Historique.txt", "")
     Endif

Catch
     Message.Info((Error.Text))

End

Public Sub btnImpr_Click()

     Dim hreport As Report
     Dim Parties As String[]

     Parties = Split(TextArea1.Text, gb.NewLine)
     hreport = New Impr1(Parties)
     hreport.preview()

End
